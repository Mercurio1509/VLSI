#!/bin/bash

# Nombre del archivo spice
archivo_spice="inversor_b"

# Nombre del archivo de salida CSV
archivo_csv="resultados_b1.csv"

# Iterar sobre los valores de WP
for multiplicador in $(seq 0.5 0.1 8); do
    # Modificar el archivo spice con el nuevo valor de WP
    sed -i "s/WP=440n/WP=$(echo "440*$multiplicador" | bc -l)n/g" "$archivo_spice"
    
    # Ejecutar HSPICE
    hspice "$archivo_spice"
    
    # Extraer los valores de tpdr y tpdf del archivo .mt0
    tpdr=$(awk 'NR==4 {print $1}' "${archivo_spice}.mt0")
    tpdf=$(awk 'NR==4 {print $2}' "${archivo_spice}.mt0")
    
    # Escribir en el archivo CSV
    echo "$multiplicador,$tpdr,$tpdf" >> "$archivo_csv"
done

echo "Proceso completado. Los resultados se han guardado en $archivo_csv."
